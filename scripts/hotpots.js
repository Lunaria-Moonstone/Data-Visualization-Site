var senior_ad = ["黑龙江省", "哈尔滨市", "齐齐哈尔市", "牡丹江市", "佳木斯市", "大庆市", "大兴安岭市", "黑河市", "绥化市", "伊春市", "鹤岗市", "双鸭山市", "七台河市", "鸡西市"]
var adcode_map = {
  "黑龙江省": "230000",
  "哈尔滨市": "230100",
  "市辖区": "230101",
  "道里区": "230102",
  "南岗区": "230103",
  "道外区": "230104",
  "平房区": "230108",
  "松北区": "230109",
  "香坊区": "230110",
  "呼兰区": "230111",
  "阿城区": "230112",
  "依兰县": "230123",
  "方正县": "230124",
  "宾县": "230125",
  "巴彦县": "230126",
  "木兰县": "230127",
  "通河县": "230128",
  "延寿县": "230129",
  "双城市": "230182",
  "尚志市": "230183",
  "五常市": "230184",
  "齐齐哈尔市": "230200",
  "市辖区": "230201",
  "龙沙区": "230202",
  "建华区": "230203",
  "铁锋区": "230204",
  "昂昂溪区": "230205",
  "富拉尔基区": "230206",
  "碾子山区": "230207",
  "梅里斯达斡尔族区": "230208",
  "龙江县": "230221",
  "依安县": "230223",
  "泰来县": "230224",
  "甘南县": "230225",
  "富裕县": "230227",
  "克山县": "230229",
  "克东县": "230230",
  "拜泉县": "230231",
  "讷河市": "230281",
  "鸡西市": "230300",
  "市辖区": "230301",
  "鸡冠区": "230302",
  "恒山区": "230303",
  "滴道区": "230304",
  "梨树区": "230305",
  "城子河区": "230306",
  "麻山区": "230307",
  "鸡东县": "230321",
  "虎林市": "230381",
  "密山市": "230382",
  "鹤岗市": "230400",
  "市辖区": "230401",
  "向阳区": "230402",
  "工农区": "230403",
  "南山区": "230404",
  "兴安区": "230405",
  "东山区": "230406",
  "兴山区": "230407",
  "萝北县": "230421",
  "绥滨县": "230422",
  "双鸭山市": "230500",
  "市辖区": "230501",
  "尖山区": "230502",
  "岭东区": "230503",
  "四方台区": "230505",
  "宝山区": "230506",
  "集贤县": "230521",
  "友谊县": "230522",
  "宝清县": "230523",
  "饶河县": "230524",
  "大庆市": "230600",
  "市辖区": "230601",
  "萨尔图区": "230602",
  "龙凤区": "230603",
  "让胡路区": "230604",
  "红岗区": "230605",
  "大同区": "230606",
  "肇州县": "230621",
  "肇源县": "230622",
  "林甸县": "230623",
  "杜尔伯特蒙古族自治县": "230624",
  "伊春市": "230700",
  "市辖区": "230701",
  "伊春区": "230702",
  "南岔区": "230703",
  "友好区": "230704",
  "西林区": "230705",
  "翠峦区": "230706",
  "新青区": "230707",
  "美溪区": "230708",
  "金山屯区": "230709",
  "五营区": "230710",
  "乌马河区": "230711",
  "汤旺河区": "230712",
  "带岭区": "230713",
  "乌伊岭区": "230714",
  "红星区": "230715",
  "上甘岭区": "230716",
  "嘉荫县": "230722",
  "铁力市": "230781",
  "佳木斯市": "230800",
  "市辖区": "230801",
  "向阳区": "230803",
  "前进区": "230804",
  "东风区": "230805",
  "郊区": "230811",
  "桦南县": "230822",
  "桦川县": "230826",
  "汤原县": "230828",
  "抚远县": "230833",
  "同江市": "230881",
  "富锦市": "230882",
  "七台河市": "230900",
  "市辖区": "230901",
  "新兴区": "230902",
  "桃山区": "230903",
  "茄子河区": "230904",
  "勃利县": "230921",
  "牡丹江市": "231000",
  "市辖区": "231001",
  "东安区": "231002",
  "阳明区": "231003",
  "爱民区": "231004",
  "西安区": "231005",
  "东宁县": "231024",
  "林口县": "231025",
  "绥芬河市": "231081",
  "海林市": "231083",
  "宁安市": "231084",
  "穆棱市": "231085",
  "黑河市": "231100",
  "市辖区": "231101",
  "爱辉区": "231102",
  "嫩江县": "231121",
  "逊克县": "231123",
  "孙吴县": "231124",
  "北安市": "231181",
  "五大连池市": "231182",
  "绥化市": "231200",
  "市辖区": "231201",
  "北林区": "231202",
  "望奎县": "231221",
  "兰西县": "231222",
  "青冈县": "231223",
  "庆安县": "231224",
  "明水县": "231225",
  "绥棱县": "231226",
  "安达市": "231281",
  "肇东市": "231282",
  "海伦市": "231283",
  "大兴安岭地区": "232700",
  "加格达奇区": "232701",
  "松岭区": "232702",
  "新林区": "232703",
  "呼中区": "232704",
  "呼玛县": "232721",
  "塔河县": "232722",
  "漠河县": "232723",
}

var chartDom
var myChart
var option

function buildMap(adcode) {
  option = {}
  // https://geo.datav.aliyun.com/areas_v3/bound/230102.json
  let url = senior_ad.findIndex(x => adcode_map[x] === adcode) !== -1 ? `https://geo.datav.aliyun.com/areas_v3/bound/${adcode}_full.json` : `https://geo.datav.aliyun.com/areas_v3/bound/${adcode}.json`
  console.log(url)
  $.get(url, (geoJSON) => {
    console.log('geoJSON', geoJSON)
    myChart.hideLoading()
    echarts.registerMap('HeiLongJiang', geoJSON)
    myChart.setOption(option = {
      title: {
        text: '黑龙江区域房地产销量热点地图',
        subtext: '版权所有',
      },
      tooltip: {
        trigger: 'item',
        formatter: '{b}<br/>{c} (万/套)'
      },
      toolbox: {
        show: true,
        origin: 'vertical',
        left: 'right',
        top: 'center',
        feature: {
          dataView: { readonly: false },
          restore: {},
          // saveAsImage: {}
        }
      },
      visualMap: {
        min: 8,
        max: 20,
        realtime: false,
        calculable: true,
        inRange: {
          color: ['lightskyblue', 'yellow', 'orangered']
        }
      },
      series: [
        {
          name: '销量',
          type: 'map',
          map: 'HeiLongJiang',
          label: {
            show: true,
          },
          data: [
            { "name": "黑龙江省", "value": 98, "adcode": "230000" },
            { "name": "哈尔滨市", "value": 30, "adcode": "230100" },
            { "name": "市辖区", "value": 55, "adcode": "230101" },
            { "name": "道里区", "value": 83, "adcode": "230102" },
            { "name": "南岗区", "value": 2, "adcode": "230103" },
            { "name": "道外区", "value": 5, "adcode": "230104" },
            { "name": "平房区", "value": 71, "adcode": "230108" },
            { "name": "松北区", "value": 23, "adcode": "230109" },
            { "name": "香坊区", "value": 47, "adcode": "230110" },
            { "name": "呼兰区", "value": 50, "adcode": "230111" },
            { "name": "阿城区", "value": 91, "adcode": "230112" },
            { "name": "依兰县", "value": 64, "adcode": "230123" },
            { "name": "方正县", "value": 65, "adcode": "230124" },
            { "name": "宾县", "value": 37, "adcode": "230125" },
            { "name": "巴彦县", "value": 81, "adcode": "230126" },
            { "name": "木兰县", "value": 38, "adcode": "230127" },
            { "name": "通河县", "value": 89, "adcode": "230128" },
            { "name": "延寿县", "value": 20, "adcode": "230129" },
            { "name": "双城市", "value": 86, "adcode": "230182" },
            { "name": "尚志市", "value": 100, "adcode": "230183" },
            { "name": "五常市", "value": 85, "adcode": "230184" },
            { "name": "齐齐哈尔市", "value": 51, "adcode": "230200" },
            { "name": "市辖区", "value": 19, "adcode": "230201" },
            { "name": "龙沙区", "value": 90, "adcode": "230202" },
            { "name": "建华区", "value": 34, "adcode": "230203" },
            { "name": "铁锋区", "value": 6, "adcode": "230204" },
            { "name": "昂昂溪区", "value": 17, "adcode": "230205" },
            { "name": "富拉尔基区", "value": 34, "adcode": "230206" },
            { "name": "碾子山区", "value": 35, "adcode": "230207" },
            { "name": "梅里斯达斡尔族区", "value": 77, "adcode": "230208" },
            { "name": "龙江县", "value": 39, "adcode": "230221" },
            { "name": "依安县", "value": 68, "adcode": "230223" },
            { "name": "泰来县", "value": 100, "adcode": "230224" },
            { "name": "甘南县", "value": 16, "adcode": "230225" },
            { "name": "富裕县", "value": 57, "adcode": "230227" },
            { "name": "克山县", "value": 10, "adcode": "230229" },
            { "name": "克东县", "value": 62, "adcode": "230230" },
            { "name": "拜泉县", "value": 53, "adcode": "230231" },
            { "name": "讷河市", "value": 21, "adcode": "230281" },
            { "name": "鸡西市", "value": 44, "adcode": "230300" },
            { "name": "市辖区", "value": 97, "adcode": "230301" },
            { "name": "鸡冠区", "value": 9, "adcode": "230302" },
            { "name": "恒山区", "value": 61, "adcode": "230303" },
            { "name": "滴道区", "value": 1, "adcode": "230304" },
            { "name": "梨树区", "value": 44, "adcode": "230305" },
            { "name": "城子河区", "value": 34, "adcode": "230306" },
            { "name": "麻山区", "value": 70, "adcode": "230307" },
            { "name": "鸡东县", "value": 51, "adcode": "230321" },
            { "name": "虎林市", "value": 7, "adcode": "230381" },
            { "name": "密山市", "value": 6, "adcode": "230382" },
            { "name": "鹤岗市", "value": 5, "adcode": "230400" },
            { "name": "市辖区", "value": 32, "adcode": "230401" },
            { "name": "向阳区", "value": 85, "adcode": "230402" },
            { "name": "工农区", "value": 59, "adcode": "230403" },
            { "name": "南山区", "value": 80, "adcode": "230404" },
            { "name": "兴安区", "value": 50, "adcode": "230405" },
            { "name": "东山区", "value": 53, "adcode": "230406" },
            { "name": "兴山区", "value": 75, "adcode": "230407" },
            { "name": "萝北县", "value": 74, "adcode": "230421" },
            { "name": "绥滨县", "value": 70, "adcode": "230422" },
            { "name": "双鸭山市", "value": 69, "adcode": "230500" },
            { "name": "市辖区", "value": 61, "adcode": "230501" },
            { "name": "尖山区", "value": 19, "adcode": "230502" },
            { "name": "岭东区", "value": 59, "adcode": "230503" },
            { "name": "四方台区", "value": 90, "adcode": "230505" },
            { "name": "宝山区", "value": 82, "adcode": "230506" },
            { "name": "集贤县", "value": 62, "adcode": "230521" },
            { "name": "友谊县", "value": 45, "adcode": "230522" },
            { "name": "宝清县", "value": 25, "adcode": "230523" },
            { "name": "饶河县", "value": 1, "adcode": "230524" },
            { "name": "大庆市", "value": 85, "adcode": "230600" },
            { "name": "市辖区", "value": 26, "adcode": "230601" },
            { "name": "萨尔图区", "value": 81, "adcode": "230602" },
            { "name": "龙凤区", "value": 99, "adcode": "230603" },
            { "name": "让胡路区", "value": 19, "adcode": "230604" },
            { "name": "红岗区", "value": 11, "adcode": "230605" },
            { "name": "大同区", "value": 39, "adcode": "230606" },
            { "name": "肇州县", "value": 38, "adcode": "230621" },
            { "name": "肇源县", "value": 22, "adcode": "230622" },
            { "name": "林甸县", "value": 33, "adcode": "230623" },
            { "name": "杜尔伯特蒙古族自治县", "value": 81, "adcode": "230624" },
            { "name": "伊春市", "value": 66, "adcode": "230700" },
            { "name": "市辖区", "value": 66, "adcode": "230701" },
            { "name": "伊春区", "value": 28, "adcode": "230702" },
            { "name": "南岔区", "value": 95, "adcode": "230703" },
            { "name": "友好区", "value": 56, "adcode": "230704" },
            { "name": "西林区", "value": 43, "adcode": "230705" },
            { "name": "翠峦区", "value": 16, "adcode": "230706" },
            { "name": "新青区", "value": 97, "adcode": "230707" },
            { "name": "美溪区", "value": 59, "adcode": "230708" },
            { "name": "金山屯区", "value": 64, "adcode": "230709" },
            { "name": "五营区", "value": 97, "adcode": "230710" },
            { "name": "乌马河区", "value": 0, "adcode": "230711" },
            { "name": "汤旺河区", "value": 26, "adcode": "230712" },
            { "name": "带岭区", "value": 41, "adcode": "230713" },
            { "name": "乌伊岭区", "value": 56, "adcode": "230714" },
            { "name": "红星区", "value": 53, "adcode": "230715" },
            { "name": "上甘岭区", "value": 94, "adcode": "230716" },
            { "name": "嘉荫县", "value": 82, "adcode": "230722" },
            { "name": "铁力市", "value": 88, "adcode": "230781" },
            { "name": "佳木斯市", "value": 17, "adcode": "230800" },
            { "name": "市辖区", "value": 65, "adcode": "230801" },
            { "name": "向阳区", "value": 88, "adcode": "230803" },
            { "name": "前进区", "value": 2, "adcode": "230804" },
            { "name": "东风区", "value": 15, "adcode": "230805" },
            { "name": "郊区", "value": 75, "adcode": "230811" },
            { "name": "桦南县", "value": 99, "adcode": "230822" },
            { "name": "桦川县", "value": 4, "adcode": "230826" },
            { "name": "汤原县", "value": 92, "adcode": "230828" },
            { "name": "抚远县", "value": 1, "adcode": "230833" },
            { "name": "同江市", "value": 77, "adcode": "230881" },
            { "name": "富锦市", "value": 24, "adcode": "230882" },
            { "name": "七台河市", "value": 15, "adcode": "230900" },
            { "name": "市辖区", "value": 58, "adcode": "230901" },
            { "name": "新兴区", "value": 39, "adcode": "230902" },
            { "name": "桃山区", "value": 56, "adcode": "230903" },
            { "name": "茄子河区", "value": 12, "adcode": "230904" },
            { "name": "勃利县", "value": 60, "adcode": "230921" },
            { "name": "牡丹江市", "value": 25, "adcode": "231000" },
            { "name": "市辖区", "value": 61, "adcode": "231001" },
            { "name": "东安区", "value": 100, "adcode": "231002" },
            { "name": "阳明区", "value": 21, "adcode": "231003" },
            { "name": "爱民区", "value": 93, "adcode": "231004" },
            { "name": "西安区", "value": 95, "adcode": "231005" },
            { "name": "东宁县", "value": 53, "adcode": "231024" },
            { "name": "林口县", "value": 81, "adcode": "231025" },
            { "name": "绥芬河市", "value": 17, "adcode": "231081" },
            { "name": "海林市", "value": 94, "adcode": "231083" },
            { "name": "宁安市", "value": 45, "adcode": "231084" },
            { "name": "穆棱市", "value": 97, "adcode": "231085" },
            { "name": "黑河市", "value": 31, "adcode": "231100" },
            { "name": "市辖区", "value": 65, "adcode": "231101" },
            { "name": "爱辉区", "value": 44, "adcode": "231102" },
            { "name": "嫩江县", "value": 66, "adcode": "231121" },
            { "name": "逊克县", "value": 57, "adcode": "231123" },
            { "name": "孙吴县", "value": 86, "adcode": "231124" },
            { "name": "北安市", "value": 53, "adcode": "231181" },
            { "name": "五大连池市", "value": 13, "adcode": "231182" },
            { "name": "绥化市", "value": 14, "adcode": "231200" },
            { "name": "市辖区", "value": 95, "adcode": "231201" },
            { "name": "北林区", "value": 32, "adcode": "231202" },
            { "name": "望奎县", "value": 35, "adcode": "231221" },
            { "name": "兰西县", "value": 81, "adcode": "231222" },
            { "name": "青冈县", "value": 44, "adcode": "231223" },
            { "name": "庆安县", "value": 39, "adcode": "231224" },
            { "name": "明水县", "value": 29, "adcode": "231225" },
            { "name": "绥棱县", "value": 55, "adcode": "231226" },
            { "name": "安达市", "value": 88, "adcode": "231281" },
            { "name": "肇东市", "value": 31, "adcode": "231282" },
            { "name": "海伦市", "value": 59, "adcode": "231283" },
            { "name": "大兴安岭地区", "value": 4, "adcode": "232700" },
            { "name": "加格达奇区", "value": 14, "adcode": "232701" },
            { "name": "松岭区", "value": 21, "adcode": "232702" },
            { "name": "新林区", "value": 63, "adcode": "232703" },
            { "name": "呼中区", "value": 91, "adcode": "232704" },
            { "name": "呼玛县", "value": 36, "adcode": "232721" },
            { "name": "塔河县", "value": 26, "adcode": "232722" },
            { "name": "漠河县", "value": 35, "adcode": "232723" }
          ]
        }
      ]
    })
  })
}

function initHotpotsMap() {
  chartDom = document.getElementById('hotpots-main-map')
  myChart = echarts.init(chartDom)
  myChart.showLoading()
  buildMap(adcode_map['黑龙江省'])
  myChart.on('click', function (params) {
    console.log(params.data)
    if (params.name in adcode_map) {
      buildMap(params.data['adcode'])
      option && myChart.setOption(option)
    } else {
      console.info('deepest limit')
    }
  })
  myChart.on('restore', function () {
    buildMap(adcode_map['黑龙江省'])
    option && myChart.setOption(option)
  })
  option && myChart.setOption(option)
}

function destroyHotpotsMap() {
  echarts.dispose(myChart)
}